version: '3.8'

services:
  pytorch-gpu:
    build:
      context: .
      args:
        USER_UID: 1000  # 默认1000
        USER_GID: 1000
    image: bubulamb/pytorch:2.7.0-cuda12.8-cudnn9-devel-customize
    command: ["tail", "-f", "/dev/null"]
    container_name: pytorch-gpu
    restart: unless-stopped
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              capabilities: [gpu]
              count: 1
    environment:
      - NVIDIA_VISIBLE_DEVICES=all
      - NVIDIA_DRIVER_CAPABILITIES=compute,utility
    volumes:
      - /home/zqy/learningFile:/learningFile
    stdin_open: true
    tty: true